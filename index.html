<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>検査申請</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: system-ui, sans-serif;
      padding: 20px;
    }
    label {
      display: block;
      margin-top: 12px;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      font-size: 16px;
    }
    button {
      margin-top: 20px;
    }
  </style>
</head>
<body>

<h2>検査申請フォーム</h2>

<label>業者名
  <input id="vendor">
</label>

<label>船番
  <input id="shipNo">
</label>

<label>ブロック
  <input id="block">
</label>

<label>区画
  <select id="area">
    <option value="全量">全量</option>
    <option value="半分">半分</option>
  </select>
</label>

<label>検査日
  <input type="date" id="date">
</label>

<label>時間
  <select id="time">
    <option>08:00</option>
    <option>09:00</option>
    <option>10:00</option>
    <option>11:00</option>
    <option>13:00</option>
    <option>14:00</option>
    <option>15:00</option>
    <option>16:00</option>
    <option>17:00</option>
  </select>
</label>

<label>検査場所
  <select id="place">
    <option>A棟</option>
    <option>B棟</option>
    <option>C棟</option>
    <option>ブロック置き場</option>
    <option>SUB</option>
  </select>
</label>

<label>備考
  <textarea id="note"></textarea>
</label>

<button type="button" onclick="submitForm()">申請する</button>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbwxP-L34iHY8zNjIqLJMbmXgmv36JHvSj3uCjNaTI5rEo0y3mcmil6gmFAM28kOWLTaQw/exec";

function submitForm() {
  fetch(GAS_URL, {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      vendor: vendor.value,
      shipNo: shipNo.value,
      block: block.value,
      area: area.value,
      date: date.value,
      time: time.value,
      place: place.value,
      note: note.value
    })
  })
  .then(res => res.json())
  .then(data => {
    if (data.result === "OK") {
      alert("申請完了しました");
    } else {
      alert("申請失敗：" + data.message);
    }
  })
  .catch(() => {
    alert("通信エラーが発生しました");
  });
}
</script>

</body>
</html>
