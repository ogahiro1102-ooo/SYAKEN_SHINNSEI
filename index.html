<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>社内検査 申請</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<h2>社内検査 申請</h2>

<form id="form">
  <input name="vendor" placeholder="業者名" required><br>
  <input name="shipNo" placeholder="船番" required><br>
  <input name="block" placeholder="ブロック" required><br>

  <!-- 追加①：区画 -->
  <input name="area" placeholder="区画"><br>

  <input type="date" name="date"><br>

  <select name="time">
    <option>8:00</option><option>9:00</option><option>10:00</option>
    <option>11:00</option><option>13:00</option><option>14:00</option>
    <option>15:00</option><option>16:00</option><option>17:00</option>
  </select><br>

  <select name="place">
    <option>A棟</option>
    <option>B棟</option>
    <option>C棟</option>
    <option>ブロック置き場</option>
  </select><br>

  <!-- 追加②：備考 -->
  <textarea name="note" placeholder="備考"></textarea><br>

  <button type="submit">申請</button>
</form>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbzbeJoOOtJYBH0xET8twTI5tp5tz1PX6iHHD4WZWsmy5tSCtymRI06cOa37LPKaPjWzjw/exec";

document.getElementById("form").addEventListener("submit", (e) => {
  e.preventDefault();

  const form = e.target;

  // 検査日 未指定 → 翌日
  if (!form.date.value) {
    const d = new Date();
    d.setDate(d.getDate() + 1);
    form.date.value = d.toISOString().slice(0,10);
  }

  const formData = new FormData(form);

  fetch(GAS_URL, {
    method: "POST",
    body: formData
  })
  .then(() => {
    alert("申請完了しました");
    form.reset();
  })
  .catch(() => {
    alert("申請失敗");
  });
});
</script>

</body>
</html>
