<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>検査申請</title>
</head>
<body>

<h2>検査申請</h2>

<form id="form">
  <div>業者名：<input id="vendor" required></div>
  <div>船番：<input id="shipNo" required></div>
  <div>ブロック：<input id="block" required></div>

  <div>
    区画：
    <select id="area">
      <option value="全量">全量</option>
      <option value="半分">半分</option>
    </select>
  </div>

  <div>検査日：<input type="date" id="date" required></div>

  <div>
    時間：
    <select id="time">
      <option>08:00</option>
      <option>09:00</option>
      <option>10:00</option>
      <option>11:00</option>
      <option>13:00</option>
      <option>14:00</option>
      <option>15:00</option>
      <option>16:00</option>
      <option>17:00</option>
    </select>
  </div>

  <div>
    検査場所：
    <select id="place">
      <option>A棟</option>
      <option>B棟</option>
      <option>C棟</option>
      <option>ブロック置き場</option>
      <option value="その他">その他</option>
    </select>
  </div>

  <div>備考：<input id="note"></div>

  <button type="submit">申請</button>
</form>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbydj6gZ4sxuzQGdk4sB_ZFF9GgLPZQwMCDHv5ZR0hlODrVjIOCwCVOgpXOhVV8X5-H2gw/exec";

document.getElementById("form").addEventListener("submit", e => {
  e.preventDefault();

  fetch(GAS_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      vendor: vendor.value,
      shipNo: shipNo.value,
      block: block.value,
      area: area.value,
      date: date.value,
      time: time.value,
      place: place.value,
      note: note.value
    })
  })
  .then(res => res.text())
  .then(text => {
    if (text === "OK") {
      alert("申請完了しました");
      document.getElementById("form").reset();
    } else {
      alert("申請失敗：" + text);
    }
  })
  .catch(() => {
    alert("通信エラーが発生しました");
  });
});
</script>

</body>
</html>
