<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>社内検査 申請フォーム</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ===== CSS ===== -->
  <style>
    body {
      font-family: sans-serif;
      background: #f7f7f7;
      margin: 0;
      padding: 16px;
    }
    main {
      max-width: 480px;
      margin: auto;
      background: #fff;
      padding: 16px;
      border-radius: 8px;
    }
    label {
      display: block;
      margin-bottom: 12px;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 6px;
      margin-top: 4px;
    }
    button {
      background: #1976d2;
      color: #fff;
      border: none;
      border-radius: 4px;
      font-size: 16px;
    }
    #message {
      margin-top: 12px;
      font-weight: bold;
    }
  </style>
</head>

<body>
<main>
  <h1>社内検査 申請フォーム</h1>

  <form id="applyForm">
    <label>
      協力業者名
      <input type="text" id="vendor" required>
    </label>

    <label>
      検査日
      <input type="date" id="date">
    </label>

    <label>
      検査時間
      <select id="hour" required>
        <option value="">選択してください</option>
        <option>08:00</option>
        <option>09:00</option>
        <option>10:00</option>
        <option>11:00</option>
        <option>12:00</option>
        <option>13:00</option>
        <option>14:00</option>
        <option>15:00</option>
        <option>16:00</option>
        <option>17:00</option>
      </select>
    </label>

    <label>
      検査場所
      <select id="placeBase" required>
        <option value="">選択してください</option>
        <option>A棟</option>
        <option>B棟</option>
        <option>C棟</option>
        <option>ブロック置き場</option>
        <option>SUB</option>
        <option>その他</option>
      </select>
    </label>

    <label id="placeOtherArea" style="display:none;">
      検査場所（自由記述）
      <input type="text" id="placeOther">
    </label>

    <label>
      船番
      <input type="text" id="ship" required>
    </label>

    <label>
      ブロック
      <input type="text" id="block" required>
    </label>

    <label>
      区画
      <select id="area">
        <option>半分</option>
        <option>全量</option>
      </select>
    </label>

    <label>
      備考
      <textarea id="note"></textarea>
    </label>

    <button type="submit">申請する</button>
  </form>

  <p id="message"></p>
</main>

<!-- ===== JavaScript ===== -->
<script>
  /* ===== 設定 ===== */
  const GAS_URL = "https://script.google.com/macros/s/AKfycbxnXs0YpgQU8tajqk6u6iQZ4bqKnIdOUI0zwgJIy5bW8AtzLK1FypEC0cQK_rM3KubSPw/exec"

  const form = document.getElementById("applyForm");
  const message = document.getElementById("message");
  const dateInput = document.getElementById("date");
  const placeBase = document.getElementById("placeBase");
  const placeOtherArea = document.getElementById("placeOtherArea");

  /* 検査日：未指定なら翌日 */
  if (!dateInput.value) {
    const tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate() + 1);
    dateInput.value = tomorrow.toISOString().slice(0, 10);
  }

  /* 検査場所：その他 */
  placeBase.addEventListener("change", () => {
    placeOtherArea.style.display =
      placeBase.value === "その他" ? "block" : "none";
  });

  /* 送信 */
  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const data = {
      vendor: vendor.value,
      date: dateInput.value,
      hour: hour.value,
      place:
        placeBase.value === "その他"
          ? placeOther.value
          : placeBase.value,
      ship: ship.value,
      block: block.value,
      area: area.value,
      note: note.value,
      timestamp: new Date().toISOString()
    };

    try {
      await fetch(GAS_URL, {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" }
      });

      message.textContent = "申請を受け付けました。";
      form.reset();
    } catch (err) {
      message.textContent = "送信に失敗しました。";
    }
  });
</script>
</body>
</html>
